<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Select Seats</title>
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(120deg, #b7eaff 0%, #ffe0f5 100%);
      margin: 0;
      padding: 0 0 30px 0;
      color: #2c3e50;
      min-height: 100vh;
      user-select: none;
      text-align: center;
    }
    h1 {
      font-weight: 700;
      margin: 36px auto 24px auto;
      color: #7a5cf4;
      letter-spacing: 1px;
      text-shadow: 0 2px 18px #ffc4d6aa;
    }
    #seat-map {
      max-width: 900px;
      margin: 0 auto 30px auto;
      background: linear-gradient(120deg, #e6f4fe 90%, #ffe5fa 100%);
      border-radius: 22px;
      padding: 36px 0 24px 0;
      box-shadow: 0 4px 32px 0 #efb5d920;
    }
    .seat-row {
      margin-bottom: 13px;
      text-align: center;
      font-weight: 400;
      font-size: 0.95rem;
      color: #7d5ca6;
      letter-spacing: 1px;
      text-shadow: 0 1px 7px #f9d6f555;
    }
    .regular-seat, .stadium-seat {
      display: inline-block;
      width: 26px;
      height: 26px;
      margin: 4px 4px;
      background: linear-gradient(135deg, #d9eaff 88%, #ffe0f6 100%);
      border-radius: 7px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 700;
      font-family: "Segoe UI", Arial, sans-serif;
      color: #5272f2;
      user-select: none;
      border: 1.5px solid #ffaddb;
      box-shadow: 1px 2px 9px #ffd5f9a0;
      line-height: 26px;
      text-align: center;
      vertical-align: middle;
      transition: 
        background 0.22s,
        color 0.18s,
        box-shadow 0.20s,
        transform 0.13s;
      outline: none;
    }
    .regular-seat:hover, .stadium-seat:hover {
      background: #ffa0d8; /* bright pink highlight */
      color: #fff;
      border-color: #ff68b4;
      box-shadow: 0 0 14px 3px #ffa0d889;
      transform: scale(1.15);
      z-index: 2;
      position: relative;
    }
    .regular-seat.selected, .stadium-seat.selected {
      background: #ff68b4; /* strong pink when selected */
      color: #fff;
      border-color: #b76fff;
      box-shadow: 0 0 20px 4px #dcb8ffba;
      transform: scale(1.16);
      z-index: 3;
      position: relative;
    }
    .regular-seat.unavailable, .stadium-seat.unavailable {
      background: #d3d7db !important;
      border: 1.2px dashed #bf90b8;
      color: #b0b0b0;
      cursor: not-allowed;
      opacity: 0.5;
      text-decoration: line-through;
      box-shadow: none;
    }
    .stadium-section {
      margin-bottom: 28px;
      border-radius: 14px;
      padding: 14px 15px 17px 15px;
      background: linear-gradient(120deg, #fbe1ff 63%, #d5ecff 100%);
      border: 2px solid #ffe0f6;
      box-shadow: 0 0 8px #eac3ffcc;
      transition: background 0.15s ease;
    }
    .stadium-section h2 {
      margin-bottom: 12px;
      color: #7a5cf4;
      font-size: 1.21rem;
      font-weight: 800;
      letter-spacing: 1.1px;
      text-shadow: 1px 1px 8px #fbc2eb99;
    }
    /* Slightly different pastel blends per section */
    .stadium-section.section-0 { background: linear-gradient(120deg, #e6f4fe 62%, #ffe0f6 100%); }
    .stadium-section.section-1 { background: linear-gradient(120deg, #e0d3ff 62%, #bfd8ff 100%); }
    .stadium-section.section-2 { background: linear-gradient(120deg, #fbd6ec 65%, #cfeaff 100%); }
    .stadium-section.section-3 { background: linear-gradient(120deg, #ffd6f2 65%, #bdd3fc 100%); }
    .stadium-section.section-4 { background: linear-gradient(120deg, #eddaff 65%, #c2e8fc 100%); }

    .curve-row-1 { margin: 0 28px; }
    .curve-row-2 { margin: 0 18px; }
    .curve-row-3 { margin: 0 10px; }
    .curve-row-4 { margin: 0 5px; }
    
    #legend {
      max-width: 900px;
      margin: 18px auto 8px auto;
      text-align: center;
      font-size: 0.96rem;
      user-select: none;
      color: #9a479a;
      font-weight: 700;
      background: #ffd5f98c;
      border-radius: .9em;
      padding: 7px 0 6px 0;
      box-shadow: 0 0 14px #b5cffa88;
    }
    #legend span {
      display: inline-block;
      margin: 4px 14px 0 14px;
      padding: 6px 16px;
      border-radius: 7.5px;
      vertical-align: middle;
      background: #ffe0faac;
      border: 1.4px solid #ff68b4;
      color: #653955;
    }
    #legend .available { background: #f3f7fd; border-color: #7a5cf4; color: #7a5cf4; }
    #legend .selected { background: #ffaddb; border-color: #ff68b4; color: #fff; }
    #legend .unavailable { background: #dad8e1; border-color: #c39ab7; color: #a3a3a3; }
    #selectedSeatsDisplay {
      color: #7a5cf4;
      font-weight: 700;
      font-size: 1.03rem;
      margin: 15px auto 23px;
      background: #ffd5f9cc;
      border-radius: 1em;
      display: inline-block;
      padding: 9px 21px;
      box-shadow: 0 1px 13px #d7eaff88;
      letter-spacing: 0.9px;
    }
    #continueBtn {
      padding: 12px 32px;
      font-size: 1rem;
      font-weight: 700;
      background: linear-gradient(90deg, #ff68b4 0%, #85c1ff 100%);
      color: #fff;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      user-select: none;
      margin-top: 20px;
      margin-bottom: 10px;
      box-shadow: 0 0 16px #b8b6fdcc;
      transition: background 0.18s, color 0.18s, box-shadow 0.2s;
    }
    #continueBtn:hover {
      background: linear-gradient(60deg, #a3cef1 0%, #ff68b4 100%);
      color: #fff0fa;
      box-shadow: 0 5px 28px #ffadeebb;
    }
  </style>
</head>
<body>
  <h1 id="eventTitle"></h1>
  <div id="seat-map"></div>
  <div id="legend">
    <span class="available">Available</span>
    <span class="selected">Selected</span>
    <span class="unavailable">Unavailable</span>
  </div>
  <div id="selectedSeatsDisplay">Selected Seats: None</div>
  <button id="continueBtn">Continue to Payment</button>
  
  <script>
    const category = localStorage.getItem('selectedCategory') || '';
    const venueName = category === 'Sport'
      ? (localStorage.getItem('selectedStadium') || 'Selected Stadium')
      : (localStorage.getItem('selectedVenue') || localStorage.getItem('theater') || 'Selected Venue');
    document.getElementById('eventTitle').textContent = `${category} Venue: ${venueName}`;
    
    const seatMapContainer = document.getElementById('seat-map');
    const selectedSeatsDisplay = document.getElementById('selectedSeatsDisplay');
    const continueBtn = document.getElementById('continueBtn');
    const bookedSeatsKey = `bookedSeats_${category}_${venueName}`;
    let bookedSeats = JSON.parse(localStorage.getItem(bookedSeatsKey)) || [];
    let selectedSeats = [];

    function updateSelectedSeatsDisplay() {
      selectedSeatsDisplay.textContent = selectedSeats.length
        ? `Selected Seats: ${selectedSeats.join(', ')}`
        : 'Selected Seats: None';
    }

    // Create seat elements with simple numeric labels (1,2,3...)
    function createSeat(seatNum, isUnavailable = false, isStadium = false) {
      const seat = document.createElement('div');
      seat.className = isStadium ? 'stadium-seat' : 'regular-seat';
      seat.textContent = seatNum; // simple numeric label
      if (isUnavailable || bookedSeats.includes(seatNum)) {
        seat.classList.add('unavailable');
      }
      seat.addEventListener('click', () => {
        if (seat.classList.contains('unavailable')) return;
        if (seat.classList.contains('selected')) {
          seat.classList.remove('selected');
          selectedSeats = selectedSeats.filter(s => s !== seatNum);
        } else {
          seat.classList.add('selected');
          selectedSeats.push(seatNum);
        }
        updateSelectedSeatsDisplay();
      });
      return seat;
    }

    // Render theater seats with numbers 1... per row
    function renderRegularSeats(rows = 10, seatsPerRow = 8) {
      seatMapContainer.innerHTML = '';
      selectedSeats = [];
      for(let r = 1; r <= rows; r++) {
        const rowDiv = document.createElement('div');
        rowDiv.className = 'seat-row';
        rowDiv.textContent = `Row ${r}: `;
        for(let s = 1; s <= seatsPerRow; s++) {
          const seatNum = s.toString();
          const randomUnavailable = Math.random() < 0.07;
          const seat = createSeat(seatNum, randomUnavailable, false);
          rowDiv.appendChild(seat);
        }
        seatMapContainer.appendChild(rowDiv);
      }
      updateSelectedSeatsDisplay();
    }

    // Render stadium seats, numbering seats 1... per row per section independently
    function renderStadiumSeats() {
      seatMapContainer.innerHTML = '';
      selectedSeats = [];
      const stadiumSections = [
        { name: "North Stand", rows: 10, seatsPerRow: 20 },
        { name: "East Stand", rows: 8, seatsPerRow: 25 },
        { name: "South Stand", rows: 10, seatsPerRow: 20 },
        { name: "West Stand", rows: 8, seatsPerRow: 25 },
        { name: "VIP Box", rows: 2, seatsPerRow: 12 }
      ];
      stadiumSections.forEach((section, idx) => {
        const sectionDiv = document.createElement('div');
        sectionDiv.className = 'stadium-section section-' + idx;
        const title = document.createElement('h2');
        title.textContent = section.name;
        sectionDiv.appendChild(title);

        for(let r = 1; r <= section.rows; r++) {
          const rowDiv = document.createElement('div');
          rowDiv.className = 'seat-row';
          if(r <= 2) rowDiv.classList.add('curve-row-1');
          else if(r <=4) rowDiv.classList.add('curve-row-2');
          else if(r <= 6) rowDiv.classList.add('curve-row-3');
          else if(r <=8) rowDiv.classList.add('curve-row-4');
          rowDiv.textContent = `Row ${r}: `;

          for(let s=1; s<=section.seatsPerRow; s++) {
            const seatNum = s.toString();
            const randomUnavailable = Math.random() < 0.08;
            const seat = createSeat(seatNum, randomUnavailable, true);
            rowDiv.appendChild(seat);
          }
          sectionDiv.appendChild(rowDiv);
        }
        seatMapContainer.appendChild(sectionDiv);
      });
      updateSelectedSeatsDisplay();
    }

    continueBtn.addEventListener('click', () => {
      if(selectedSeats.length === 0) {
        alert('Please select at least one seat to continue.');
        return;
      }
      localStorage.setItem('seats', selectedSeats.sort().join(', '));
      bookedSeats = [...new Set([...bookedSeats, ...selectedSeats])];
      localStorage.setItem(bookedSeatsKey, JSON.stringify(bookedSeats));
      window.location.href = 'payment.html';
    });

    if(category === 'Sport') {
      renderStadiumSeats();
    } else {
      renderRegularSeats();
    }
  </script>
</body>
</html>
